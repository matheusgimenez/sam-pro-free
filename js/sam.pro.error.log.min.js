(function(n){var i=options.locale.changeLocale?options.locale.locale:"en-US",t=options.wap;n(document).ready(function(){var o=n("#info-dialog"),s=n("#info-body"),u,h={width:830,allowDraggable:!0,enableModal:!0,showOnInit:!1,closeIconTooltip:options.close},f,c=ej.DataManager({url:options.samProAjax+"sam-pro-ajax-admin.php?action=load_error_log&wap="+t,removeUrl:options.samProAjax+"sam-pro-ajax-admin.php?action=remove_error&wap="+t,requestType:"json",adaptor:new ej.UrlAdaptor}),r,e;s.html(function(){return'<div style="margin: 10px 10px 10px 0;"><div style="margin: 10px 0;"><aside id="info-img" style="float: left; width: 80px; font-size: 50px;"><\/aside><div style="padding-left: 80px"> <p><strong>'+options.date+'<\/strong>: <span id="el-date"><\/span><\/p><p><strong>'+options.table+'<\/strong>: <span id="el-table"><\/span><\/p><p><strong>'+options.etype[0]+'<\/strong>: <span id="el-type"><\/span><\/p><p><strong>'+options.msg+'<\/strong>:<br><span id="el-msg"><\/span><\/p><p><strong>'+options.sql+'<\/strong>:<\/p><textarea id="el-sql" style="width: 100%; height: 270px;" readonly><\/textarea> <\/div><\/div><\/div>'});u=o.ejDialog(h).data("ejDialog");n("#close-dialog").on("click",function(){u.close()});r=n("#grid").ejGrid({dataSource:c,locale:i,allowTextWrap:!0,allowPaging:!0,allowSorting:!0,pageSettings:{pageSize:options.itemsPerPage},allowSelection:!0,selectionSettings:{selectionMode:[ej.Grid.SelectionMode.Row],enableToggle:!0},editSettings:{allowDeleting:!0},toolbarSettings:{showToolbar:!0,toolbarItems:[ej.Grid.ToolBarItems.Delete],customToolbarItems:[{templateID:"#viewMode"},"Refresh",{templateID:"#MoreInfo"},{templateID:"#ErrorSolved"},{templateID:"#ClearErrors"}]},actionComplete:function(){var i=n("#grid_toolbarItems"),t;t=n("#grid_delete");i.ejToolbar("disableItem",t);t=n("#grid_MoreInfo");i.ejToolbar("disableItem",t);t=n("#grid_ErrorSolved");i.ejToolbar("disableItem",t)},recordClick:function(){var i=n("#grid_toolbarItems"),t,u=this.getSelectedRecords(),r=u.length==0?"disableItem":"enableItem";t=n("#grid_delete");i.ejToolbar(r,t);t=n("#grid_MoreInfo");i.ejToolbar(r,t);t=n("#grid_ErrorSolved");i.ejToolbar(r,t)},toolbarClick:function(i){var s=n(i.target),o=this.getSelectedRecords(),h,c,v,l,y,a,p;s.hasClass("Refresh")?this.refreshContent():s.hasClass("more-info")?o.length>0&&(c=parseInt(o[0].etype,10),h=parseInt(o[0].solved,10),n("#info-img").html(function(){return c==1?"<i class='icon-ok'><\/i>":h==1?"<i class='icon-shield'><\/i>":"<i class='icon-attention'><\/i>"}),n("#el-date").text(o[0].edate),n("#el-table").text(o[0].tname),n("#el-type").text(options.alts[c]),n("#el-msg").text(o[0].emsg),n("#el-sql").html(o[0].esql),u.open()):s.hasClass("error-solved")?o.length>0&&(h=parseInt(o[0].solved,10),h==0&&n.post(options.samProAjax+"sam-pro-ajax-admin.php",{action:"solve_error",eid:parseInt(o[0].eid,10),wap:t}).done(function(n){n.success&&r.refreshContent()})):s.hasClass("clear-errors")?n.post(options.samProAjax+"sam-pro-ajax-admin.php",{action:"clear_error_log",wap:t}).done(function(n){n.success&&r.refreshContent()}):s.hasClass("Edit")?o.length>0&&(v=o[0].aid,document.location=options.editorUrl+v):s.hasClass("place-to-trash")||s.hasClass("place-from-trash")?(l=s.hasClass("place-to-trash")?1:0,o.length>0&&(y=parseInt(o[0].trash,10),aid=parseInt(o[0].aid,10),y!=l&&n.post(options.samProAjax+"sam-pro-ajax-admin.php",{action:"trash_ad",aid:aid,trash:l,wap:t}).done(function(){var n=parseInt(e.getSelectedValue(),10);n==0?r._disabledToolItems.push(f[8]):n==1&&r._disabledToolItems.push(f[7]);r.refreshContent()}))):(s.hasClass("ad-moderate")||s.hasClass("ad-unmoderate"))&&(a=s.hasClass("ad-moderate")?1:0,o.length>0&&(p=parseInt(o[0].moderated,10),aid=parseInt(o[0].aid,10),p!=a&&n.post(options.samProAjax+"sam-pro-ajax-admin.php",{action:"moderate_ad",aid:aid,mod:a,wap:t}).done(function(){r.refreshContent()})))},create:function(){var t=n("#grid_toolbarItems");f=t.find("li");n(".more-info").parent("li").attr("title",options.moreInfo);n(".error-solved").parent("li").attr("title",options.setSolved);n(".clear-errors").parent("li").attr("title",options.clearLog);n(".ad-unmoderate").parent("li").attr("title",options.cancelApproval);n('li[title="viewMode"]').attr("title",options.viewMode);n(".Refresh").parent("li").attr("title",options.refresh)},columns:[{field:"eid",headerText:options.id,isPrimaryKey:!0,textAlign:ej.TextAlign.Right,allowSorting:!0,allowEditing:!1,width:100},{field:"stype",headerText:options.etype[1],textAlign:ej.TextAlign.Center,allowSorting:!0,allowEditing:!1,width:100},{field:"edate",headerText:options.date,allowSorting:!0,allowEditing:!1,width:150},{field:"tname",headerText:options.table,allowSorting:!0,allowEditing:!1,width:170},{field:"emsg",headerText:options.msg,allowSorting:!0,allowEditing:!1},{field:"etype",headerText:options.status,allowSorting:!1,allowEditing:!1,visible:!1},{field:"esql",headerText:options.sql,allowSorting:!1,allowEditing:!1,visible:!1},{field:"solved",headerText:options.status,allowEditing:!1,visible:!1}]}).data("ejGrid");e=n("#view-mode").ejDropDownList({selectedItemIndex:0,change:function(){var t=parseInt(this.getSelectedValue(),10);t!=10?n("#grid").ejGrid("model.query",(new ej.Query).where("etype",ej.FilterOperators.equal,t,10)):n("#grid").ejGrid("model.query",new ej.Query);r.refreshContent(!0)}}).data("ejDropDownList")})})(jQuery)